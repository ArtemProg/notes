Сопрограмма (coroutine)

```c#
IEnumerator MoveObject() {
    while (true) {
        // Что то делаем
        yield return null; // ждать наступления следующего кадра
    }
}
```

Конструкция yield return временно приостанавливает выполнение функции. Unity автоматически возобновит ее работу позднее, но когда это произойдет, зависит от значения, возвращаемого yield return.

Например:

```yield return null ```

приостановит выполнение до следующего кадра; 

```yield return new WaitForSeconds(3)```

приостановит выполнение на три секунды;

```yield return new WaitUntil(() => this.someVariable == true)```

приостановит выполнение до момента, когда переменная someVariable получит значение true; вместо констант true и false также можно использовать любые выражения, возвращающие true или false.



Запуск сопрограммы осуществляется посредством метода:

```c#
StartCoroutine(MoveObject());
```



Остановить сопрограмму можно конструкцией yield break:

```c#
// немедленно остановит сопрограмму
yield break;
```

Кроме того, сопрограммы автоматически останавливаются, когда выполнение достигает конца метода.

Сопрограмму можно остановить извне. Для этого нужно сохранить ссылку на значение, возвращаемое методом StartCoroutine, и в нужный момент передать его в вызов метода StopCoroutine:

```c#
Coroutine myCoroutine = StartCoroutine(MyCoroutine());
// ... позднее ...
StopCoroutine(myCoroutine);
```

