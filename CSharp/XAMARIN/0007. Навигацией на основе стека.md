## Навигацией на основе стека (NavigationPage)



В Xamarin.Forms навигация на основе стека реализуется с использованием объекта `NavigationPage`. Объект `NavigationPage` управляет собственным стеком, в котором содержатся страницы, показываемые пользователю. Он также отображает панель навигации и область содержимого для текущей страницы, которая находится вверху стека навигации.

Для работы со стеком навигации в визуальном дереве приложения должен присутствовать экземпляр объекта `NavigationPage`. Как правило, объект `NavigationPage` представляет страницу верхнего уровня.

Объект `NavigationPage` содержит конструктор, который принимает параметр начальной или корневой страницы для стека.

```c#
public partial class App : Application
{
    public App()
    {
        ...
        var homePage = new HomePage();
        var navPage = new NavigationPage(homePage);
        this.MainPage = navPage;
        ...
    }
}
```



### Переход между страницами в стеке

После размещения объекта `NavigationPage` класс `NavigationPage` предоставляет методы для добавления страниц в стек и их удаления из стека. Таким образом мы меняем страницу, которую видит пользователь. Для этих задач доступны следующие методы.

```c#
public class NavigationPage : ...
{
    // Переход на новую страницу в рамках навигации на основе стека
    Task PushAsync(Page page, bool animated);
    Task PushAsync(Page page); // 'animated' is true

    //Возврат на предыдущую страницу в рамках навигации на основе стека
    Task<Page> PopAsync(bool animated);
    Task<Page> PopAsync(); // 'animated' is true
}
```

Большинство операций навигации являются асинхронными. Все эти методы представляют собой асинхронные методы, возвращающие задачи, и вы должны ожидать их завершения.



### Обработка переходов с использованием кнопки "Назад"

На панели навигации, которая отображается в верхней части пользовательского интерфейса объекта `NavigationPage`, представлена кнопка "Назад", которая автоматически извлекает текущую страницу из стека навигации. 

Переходы назад также могут обрабатываться автоматически с помощью кнопок "Назад" и соответствующих жестов устройства.



### Доступ к текущему стеку для методов навигации

Чтобы получать доступ к этим методам навигации на основе стека с различных страниц приложения, следует использовать свойство `Navigation`, представленное в классах `Page` Xamarin.Forms. Xamarin.Forms устанавливает свойство `Navigation` таким образом, чтобы оно ссылалось на текущий объект `NavigationPage`. По этой ссылке вы можете вызывать методы навигации `PushAsync` и `PopAsync`.

```c#
public partial class FoodPage : ContentPage
{
    async void OnRestaurantsClicked(object sender, EventArgs e)
    {
        var destination = new RestaurantsPage(...);
        await this.Navigation.PushAsync(destination);
        ...
    }
    ...
    async void OnCancelClicked(object sender, EventArgs e)
    {
        ...
        await this.Navigation.PopAsync();
    }
}
```

