## Паттерн Наблюдатель (Observer)



**Наблюдатель** — это поведенческий паттерн проектирования, который создаёт механизм подписки, позволяющий одним объектам следить и реагировать на события, происходящие в других объектах.

При этом наблюдатели могут свободно подписываться и отписываться от этих оповещений.

Наблюдатель можно определить по механизму подписки и методам оповещения, которые вызывают компоненты программы.



Данный паттерн относится к push-модели взаимодействия. Возможны два варианта реализации push-модели:

1. Наблюдаемый класс знает о своих наблюдателях. Хранит ссылки (интерфейсы) на них в своей коллекции. Данный вариант обеспечивает жесткую связь между классами.
2. Наблюдаемый класс уведомляет всех заинтересованных подписчиков с помощью событий. Данный вариант обеспечивает слабосвязанный дизайн, в котором классы могут развиваться независимо.



На платформе .NET практически невозможно встретить классическую реализацию паттерна «Наблюдатель». Наличие делегатов и событий, а также интерфейсов IObserver/IObservable и библиотеки реактивных расширений делает использование наследования излишним.

Существует несколько вариантов реализации паттерна «Наблюдатель» на платформе .NET:

1. с помощью делегатов (методов обратного вызова);

   Для этого достаточно, чтобы класс потребовал делегат в аргументах конструктора и уведомлял вызывающий код с его помощью.

   Данная реализация моделирует отношение 1:1 между наблюдаемым объектом и наблюдателем. Обязательное наличие наблюдателя позволяет установить двустороннюю связь: наблюдаемый объект может не только уведомлять об изменении своего состояния, но и требовать некоторого результата.

2. с помощью событий (events);

   События представляют собой умную оболочку над делегатами, которая позволяет клиентам лишь подписываться на события или отказываться от подписки, а владельцу события — еще и инициировать событие для уведомления всех подписчиков.

   Главная особенность событий в том, что класс не может гарантировать наличие наблюдателей-подписчиков, а значит, не может потребовать от них никаких результатов.

3. с помощью специализированных интерфейсов-наблюдателей;

   Строго типизированный наблюдатель, ссылка на который хранится в наблюдаемом объекте. Классический вариант реализации паттерна Наблюдатель.

4. с помощью интерфейсов IObserver/IObservable.

   Интерфейс IObservable моделирует реактивные последовательности и позволяет работать с наблюдаемыми последовательностями через привычный LINQ-синтаксис.
