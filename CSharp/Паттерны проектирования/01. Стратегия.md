## Паттерн Стратегия (Strategy)



[Стратегия](https://refactoring.guru/ru/design-patterns/strategy) — это поведенческий паттерн проектирования, который определяет семейство схожих алгоритмов и помещает каждый из них в собственный класс, после чего алгоритмы можно взаимозаменять прямо во время исполнения программы. Главной особенностью этого шаблона является то, что у клиента есть набор алгоритмов, из которых будет выбран конкретный алгоритм для использования во время выполнения.

По типу клиента (или по типу обрабатываемых данных) выбрать подходящий алгоритм, который следует применить. Если используется правило, которое не подвержено изменениям, нет необходимости обращаться к шаблону «стратегия».

```c#
public interface IStrategy { void Algorithm(); }

// Первая конкретная реализация-стратегия.
public class ConcreteStrategy1 : IStrategy
{
	public void Algorithm() { Console.WriteLine("Выполняется алгоритм стратегии 1."); }
}

// Вторая конкретная реализация-стратегия.
// Реализаций может быть сколько угодно много.
public class ConcreteStrategy2 : IStrategy
{
	public void Algorithm() { Console.WriteLine("Выполняется алгоритм стратегии 2."); }
}

// Контекст, использующий стратегию для решения своей задачи.
public class Context
{
	// Ссылка на интерфейс IStrategy позволяет автоматически переключаться
    // между конкретными реализациями (другими словами, это выбор конкретной стратегии).
	private IStrategy _strategy;
	
	// Конструктор контекста. Инициализирует объект стратегией.
	public Context(IStrategy strategy) { _strategy = strategy; }
	
	// Метод для установки стратегии. Служит для смены стратегии во время выполнения.
    // В C# может быть реализован также как свойство записи.
	public void SetStrategy(IStrategy strategy) { _strategy = strategy; }
	
	// Некоторая функциональность контекста, которая выбирает стратегию 
    // и использует её для решения своей задачи.
	public void ExecuteOperation() { _strategy.Algorithm(); }
}

// Создаём контекст и инициализируем его первой стратегией.
Context context = new Context(new ConcreteStrategy1());
// Выполняем операцию контекста, которая использует первую стратегию.
context.ExecuteOperation();
// Заменяем в контексте первую стратегию второй.
context.SetStrategy(new ConcreteStrategy2());
// Выполняем операцию контекста, которая теперь использует вторую стратегию.
context.ExecuteOperation();
```



Стратегия бывает:

1. Динамическая (в процессе выполнения приложения стратегию можно подменять)
2. Статическая (определяется в момент создания конкретного экземпляра потребителя стратегии)



Пример реализации паттерна Стратегия в .Net:

Определение способа сортировки списка

```c#
List<Worker> db = new List<Worker>();
db.Add(new() { Name = "Worker 1", Age = 23, Salary = 1 });
db.Add(new() { Name = "Worker 2", Age = 34, Salary = 5 });
db.Add(new() { Name = "Worker 3", Age = 43, Salary = 9 });
db.Add(new() { Name = "Worker 4", Age = 52, Salary = 15 });

db.Sort((a, b) => a.Age < b.Age ? -1 : 1);

foreach (var item in db) WriteLine(item);
```

